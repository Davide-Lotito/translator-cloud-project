name: "Deploy translator docker to ECR"

on:
  push:
    branches:
    - master
    paths: 
      src/translate/**

jobs:
  # Create an artifact of the translator-container generated by a Dockerfile
  docker-container:
    name: Environment set-up
    runs-on: ubuntu-latest
    environment: Production

    steps:
    - name: Checkout
      uses: actions/checkout@v3
    
    - name: Build Docker image
      id: build-translator-image
      run: |
        docker build -t translator-container .
        docker save translator-container > /tmp/translator-container.tar
      working-directory: /scripts/docker-files/translate/

    - name: Upload image artifact in a tmp file
      uses: actions/upload-artifact@v3
      with:
        name: translator-container
        path: /tmp/translator-container.tar
        
  
      
